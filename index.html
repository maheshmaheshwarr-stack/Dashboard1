<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0"
  />
  <title>Mahesh Tech News Dashboard</title>

  <style>
    :root {
      --bg: #0f172a;
      --bg-elevated: #111827;
      --bg-elevated-soft: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.1);
      --text: #e5e7eb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2937;
      --danger: #f97373;
      --radius-lg: 14px;
      --radius-xl: 18px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.85);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1d283a 0, #020617 40%, #000 100%);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 24px;
    }

    .app-shell {
      width: 100%;
      max-width: 1240px;
      background: linear-gradient(135deg, #020617 0%, #020617 50%, #020617 100%);
      border-radius: 28px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(148, 163, 184, 0.12);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 18px 24px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid rgba(148, 163, 184, 0.14);
      backdrop-filter: blur(16px);
      background: radial-gradient(circle at top left, #0b1220 0, #020617 70%);
    }

    .header-left {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .app-title {
      font-size: 1.4rem;
      font-weight: 650;
      letter-spacing: 0.02em;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }

    .app-title span.logo-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 30%, #e0f2fe, #38bdf8);
      box-shadow: 0 0 12px rgba(56, 189, 248, 0.9);
    }

    .app-subtitle {
      font-size: 0.78rem;
      color: var(--text-muted);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .pill {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.18), transparent);
      font-size: 0.72rem;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .pill-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34, 197, 94, 0.9);
    }

    main {
      display: grid;
      grid-template-columns: 240px 1fr;
      min-height: 520px;
      max-height: calc(100vh - 120px);
      overflow: hidden;
    }

    aside {
      border-right: 1px solid rgba(148, 163, 184, 0.16);
      padding: 16px 14px 18px;
      background: radial-gradient(circle at top left, #020617 0, #020617 55%, #000 100%);
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .section-label {
      font-size: 0.75rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: rgba(148, 163, 184, 0.9);
    }

    .source-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .source-button {
      width: 100%;
      text-align: left;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text-muted);
      font-size: 0.78rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      cursor: pointer;
      transition: all 0.16s ease-out;
    }

    .source-button:hover {
      border-color: rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.8);
      color: var(--text);
    }

    .source-button.active {
      border-color: rgba(56, 189, 248, 0.9);
      background: radial-gradient(circle at top left, var(--accent-soft), transparent);
      color: #f9fafb;
    }

    .source-badge {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.35);
      white-space: nowrap;
    }

    .sidebar-footer {
      margin-top: auto;
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      gap: 4px;
      opacity: 0.9;
    }

    .sidebar-footer span {
      opacity: 0.9;
    }

    .sidebar-footer strong {
      color: #e5e7eb;
    }

    section.content {
      padding: 16px 16px 20px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      background: radial-gradient(circle at top, #020617 0%, #020617 50%, #020617 100%);
    }

    .toolbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
    }

    .search-input {
      flex: 1;
      min-width: 200px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: radial-gradient(circle at top, #020617 0, #020617 70%);
      padding: 7px 11px;
      font-size: 0.8rem;
      color: var(--text);
      outline: none;
    }

    .search-input::placeholder {
      color: rgba(148, 163, 184, 0.8);
    }

    .toolbar-pill {
      font-size: 0.72rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      padding: 5px 10px;
      color: var(--text-muted);
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.16), transparent);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .status-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .status-message {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: #38bdf8;
      box-shadow: 0 0 8px rgba(56, 189, 248, 0.8);
    }

    .status-message.error .status-dot {
      background: var(--danger);
      box-shadow: 0 0 8px rgba(248, 113, 113, 0.8);
    }

    .articles-grid {
      margin-top: 4px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 14px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .article-card {
      background: linear-gradient(
        145deg,
        rgba(15, 23, 42, 0.96),
        rgba(15, 23, 42, 0.96)
      );
      border-radius: var(--radius-lg);
      border: 1px solid rgba(30, 64, 175, 0.7);
      box-shadow: 0 14px 32px rgba(15, 23, 42, 0.9);
      padding: 12px 12px 11px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.15s ease-out, box-shadow 0.15s ease-out,
        border-color 0.15s ease-out, background 0.15s ease-out;
    }

    .article-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      opacity: 0;
      background:
        radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.16), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(129, 140, 248, 0.14), transparent 60%);
      transition: opacity 0.18s ease-out;
      pointer-events: none;
    }

    .article-card:hover {
      transform: translateY(-2px) translateZ(0);
      border-color: rgba(56, 189, 248, 0.9);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 1);
      background: linear-gradient(
        135deg,
        rgba(15, 23, 42, 0.98),
        rgba(15, 23, 42, 0.98)
      );
    }

    .article-card:hover::before {
      opacity: 1;
    }

    .article-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 8px;
    }

    .article-title {
      font-size: 0.9rem;
      font-weight: 550;
      line-height: 1.25;
      color: #e5e7eb;
    }

    .article-meta {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 8px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .article-badge {
      padding: 1px 7px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.45);
      font-size: 0.7rem;
      white-space: nowrap;
    }

    .article-date {
      opacity: 0.8;
    }

    .article-description {
      font-size: 0.78rem;
      color: rgba(209, 213, 219, 0.92);
      line-height: 1.4;
      max-height: 4.2em;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .article-footer {
      margin-top: 4px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.72rem;
      color: var(--text-muted);
    }

    .article-link {
      font-size: 0.75rem;
      text-decoration: none;
      color: var(--accent);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      border-radius: 999px;
      padding: 4px 8px;
      border: 1px dashed rgba(56, 189, 248, 0.5);
      background: rgba(8, 47, 73, 0.35);
    }

    .article-link span.arrow {
      font-size: 0.8em;
      transform: translateY(1px);
    }

    footer {
      padding: 10px 18px 12px;
      font-size: 0.7rem;
      color: var(--text-muted);
      border-top: 1px solid rgba(148, 163, 184, 0.16);
      display: flex;
      justify-content: space-between;
      gap: 12px;
      background: radial-gradient(circle at bottom, #020617 0, #000 55%);
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    @media (max-width: 880px) {
      main {
        grid-template-columns: 1fr;
        max-height: none;
      }

      aside {
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.16);
        flex-direction: row;
        align-items: center;
        overflow-x: auto;
      }

      .section-label {
        display: none;
      }

      .source-list {
        flex-direction: row;
        flex-wrap: nowrap;
      }

      .sidebar-footer {
        display: none;
      }
    }

    @media (max-width: 640px) {
      body {
        padding: 12px;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
        gap: 6px;
      }

      .toolbar-pill {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="header-left">
        <div class="app-title">
          <span class="logo-dot"></span>
          Mahesh Tech Feed
        </div>
        <div class="app-subtitle">
          Live tech headlines from multiple RSS sources in one view.
        </div>
      </div>
      <div class="header-right">
        <div class="pill">
          <span class="pill-dot"></span>
          RSS auto-refresh ¬∑ client-side
        </div>
      </div>
    </header>

    <main>
      <aside>
        <div>
          <div class="section-label">Sources</div>
        </div>
        <div id="sourceList" class="source-list">
          <!-- buttons injected by JS -->
        </div>
        <div class="sidebar-footer">
          <span>Built by <strong>Mahesh</strong></span>
          <span>Data via public RSS feeds.</span>
        </div>
      </aside>

      <section class="content">
        <div class="toolbar">
          <input
            type="search"
            id="searchInput"
            class="search-input"
            placeholder="Filter headlines by keyword‚Ä¶"
          />
          <div class="toolbar-pill">
            üîÄ Use ‚ÄúCombined View‚Äù to see articles from all sources together
          </div>
        </div>

        <div class="status-bar">
          <div id="statusMessage" class="status-message">
            <span class="status-dot"></span>
            <span>Ready. Choose a source to load articles.</span>
          </div>
          <div id="countMessage">
            0 articles
          </div>
        </div>

        <div id="articles" class="articles-grid">
          <!-- article cards injected by JS -->
        </div>
      </section>
    </main>

    <footer>
      <span>RSS proxy: allorigins.win ¬∑ Some feeds may be delayed or rate-limited.</span>
      <span>Tip: Middle-click a headline to open in a new tab.</span>
    </footer>
  </div>

  <script>
    // ---------- CONFIG ----------
    // Using a public CORS proxy so most RSS feeds work in browser.
    const CORS_PROXY = "https://api.allorigins.win/raw?url=";

    const sources = [
      {
        id: "techcrunch",
        name: "TechCrunch",
        url: "https://techcrunch.com/feed/",
        region: "Global"
      },
      {
        id: "indianexpress-tech",
        name: "Indian Express ¬∑ Technology",
        url: "https://indianexpress.com/section/technology/feed/",
        region: "India"
      },
      {
        id: "better-india",
        name: "The Better India",
        url: "https://www.thebetterindia.com/feed/",
        region: "India"
      },
      {
        id: "ars-technica",
        name: "Ars Technica ¬∑ Tech",
        url: "https://feeds.arstechnica.com/arstechnica/technology-lab",
        region: "Global"
      }
      // You can easily add more sources here.
    ];

    const COMBINED_ID = "combined-view";

    // ---------- STATE ----------
    let currentSourceId = null;
    let allArticles = [];
    let lastUpdated = null;

    const sourceListEl = document.getElementById("sourceList");
    const statusMessageEl = document.getElementById("statusMessage");
    const countMessageEl = document.getElementById("countMessage");
    const articlesEl = document.getElementById("articles");
    const searchInputEl = document.getElementById("searchInput");

    // ---------- UI HELPERS ----------
    function setStatus(message, type = "normal") {
      statusMessageEl.classList.toggle("error", type === "error");
      const dotEl = statusMessageEl.querySelector(".status-dot");
      if (dotEl) {
        dotEl.style.opacity = message.toLowerCase().includes("loading") ? "1" : "0.9";
      }
      statusMessageEl.querySelector("span:nth-child(2)").textContent = message;
    }

    function setCount(count) {
      const timeInfo = lastUpdated
        ? ` ¬∑ Updated ${lastUpdated.toLocaleTimeString([], {
            hour: "2-digit",
            minute: "2-digit"
          })}`
        : "";
      countMessageEl.textContent = `${count} article${count === 1 ? "" : "s"}${timeInfo}`;
    }

    function createSourceButtons() {
      // First: Combined View button
      const combinedBtn = document.createElement("button");
      combinedBtn.className = "source-button";
      combinedBtn.dataset.sourceId = COMBINED_ID;
      combinedBtn.innerHTML = `
        <span>‚ú® Combined View</span>
        <span class="source-badge">All sources</span>
      `;
      combinedBtn.addEventListener("click", () => {
        if (currentSourceId === COMBINED_ID) {
          // re-click -> refresh combined
          loadCombinedView(true);
        } else {
          setActiveSource(COMBINED_ID);
          loadCombinedView();
        }
      });
      sourceListEl.appendChild(combinedBtn);

      // Then individual sources
      sources.forEach((source, idx) => {
        const btn = document.createElement("button");
        btn.className = "source-button";
        btn.dataset.sourceId = source.id;
        btn.innerHTML = `
          <span>${source.name}</span>
          <span class="source-badge">${source.region || "Global"}</span>
        `;
        btn.addEventListener("click", () => {
          if (currentSourceId === source.id) {
            // Re-click: just refetch
            loadSingleFeed(source.id, { force: true });
          } else {
            setActiveSource(source.id);
            loadSingleFeed(source.id);
          }
        });
        sourceListEl.appendChild(btn);
      });

      // Auto-select Combined View on page load
      setActiveSource(COMBINED_ID);
      loadCombinedView();
    }

    function setActiveSource(sourceId) {
      currentSourceId = sourceId;
      document.querySelectorAll(".source-button").forEach((btn) => {
        btn.classList.toggle(
          "active",
          btn.dataset.sourceId === sourceId
        );
      });
      searchInputEl.value = "";
    }

    // ---------- FETCH & PARSE ----------
    async function fetchFeed(source) {
      const url = CORS_PROXY + encodeURIComponent(source.url);
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error("Network error: " + response.status);
      }

      const text = await response.text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(text, "application/xml");

      if (xml.querySelector("parsererror")) {
        throw new Error("Invalid XML received from feed.");
      }

      const items =
        Array.from(xml.querySelectorAll("item")) ||
        Array.from(xml.querySelectorAll("entry"));

      const articles = items.map((item) => {
        const title =
          item.querySelector("title")?.textContent?.trim() ||
          "(no title)";
        const link =
          item.querySelector("link")?.getAttribute("href") ||
          item.querySelector("link")?.textContent?.trim() ||
          "#";
        const pubDateText =
          item.querySelector("pubDate")?.textContent ||
          item.querySelector("updated")?.textContent ||
          item.querySelector("dc\\:date")?.textContent ||
          "";
        const pubDate = pubDateText ? new Date(pubDateText) : null;
        const description =
          item.querySelector("description")?.textContent ||
          item.querySelector("content")?.textContent ||
          "";

        return {
          sourceName: source.name,
          title,
          link,
          pubDate,
          description: stripHtml(description),
        };
      });

      return articles;
    }

    async function loadSingleFeed(sourceId, options = {}) {
      const source = sources.find((s) => s.id === sourceId);
      if (!source) return;

      setStatus(`Loading ${source.name}‚Ä¶`);
      setCount(0);
      articlesEl.innerHTML = "";

      try {
        const articles = await fetchFeed(source);

        allArticles = articles.slice().sort((a, b) => {
          if (!a.pubDate && !b.pubDate) return 0;
          if (!a.pubDate) return 1;
          if (!b.pubDate) return -1;
          return b.pubDate - a.pubDate;
        });

        lastUpdated = new Date();
        renderArticles(allArticles);
        setStatus(`Showing latest from ${source.name}.`);
        setCount(allArticles.length);
      } catch (err) {
        console.error(err);
        setStatus(
          `Could not load ${source.name}. (Possible CORS/limit issue)`,
          "error"
        );
        setCount(0);
      }
    }

    async function loadCombinedView(force = false) {
      setStatus("Loading combined view from all sources‚Ä¶");
      setCount(0);
      articlesEl.innerHTML = "";

      const results = [];
      const failedSources = [];

      // Fetch all sources in parallel
      await Promise.all(
        sources.map(async (source) => {
          try {
            const articles = await fetchFeed(source);
            results.push(...articles);
          } catch (err) {
            console.error("Failed to load", source.name, err);
            failedSources.push(source.name);
          }
        })
      );

      allArticles = results.slice().sort((a, b) => {
        if (!a.pubDate && !b.pubDate) return 0;
        if (!a.pubDate) return 1;
        if (!b.pubDate) return -1;
        return b.pubDate - a.pubDate;
      });

      lastUpdated = new Date();
      renderArticles(allArticles);

      if (failedSources.length) {
        setStatus(
          `Combined view loaded with ${allArticles.length} articles. Skipped: ${failedSources.join(
            ", "
          )}.`,
          "error"
        );
      } else {
        setStatus(
          `Combined view: showing latest from ${sources.length} sources.`
        );
      }
      setCount(allArticles.length);
    }

    function stripHtml(html) {
      const tmp = document.createElement("div");
      tmp.innerHTML = html;
      return tmp.textContent || tmp.innerText || "";
    }

    // ---------- RENDER ----------
    function renderArticles(articles) {
      articlesEl.innerHTML = "";

      if (!articles.length) {
        const msg = document.createElement("div");
        msg.style.fontSize = "0.8rem";
        msg.style.color = "var(--text-muted)";
        msg.textContent = "No articles match your current filters.";
        articlesEl.appendChild(msg);
        return;
      }

      articles.forEach((article) => {
        const card = document.createElement("article");
        card.className = "article-card";

        const formattedDate = article.pubDate
          ? article.pubDate.toLocaleString(undefined, {
              day: "2-digit",
              month: "short",
              hour: "2-digit",
              minute: "2-digit"
            })
          : "No date";

        const shortDesc =
          article.description.length > 260
            ? article.description.slice(0, 260) + "‚Ä¶"
            : article.description;

        card.innerHTML = `
          <div class="article-header">
            <h3 class="article-title">${article.title}</h3>
          </div>
          <div class="article-meta">
            <span class="article-badge">${article.sourceName}</span>
            <span class="article-date">${formattedDate}</span>
          </div>
          <p class="article-description">
            ${shortDesc || "<em>No summary provided.</em>"}
          </p>
          <div class="article-footer">
            <span>Opens in new tab</span>
            <a href="${article.link}" target="_blank" rel="noopener noreferrer" class="article-link">
              Read full story <span class="arrow">‚Üó</span>
            </a>
          </div>
        `;

        // Also allow clicking card body
        card.addEventListener("click", (e) => {
          const isLink =
            e.target.closest &&
            e.target.closest(".article-link");
          if (!isLink && article.link && article.link !== "#") {
            window.open(article.link, "_blank", "noopener");
          }
        });

        articlesEl.appendChild(card);
      });
    }

    // ---------- FILTER ----------
    searchInputEl.addEventListener("input", () => {
      const query = searchInputEl.value.toLowerCase().trim();
      if (!query) {
        renderArticles(allArticles);
        setCount(allArticles.length);
        return;
      }

      const filtered = allArticles.filter((article) => {
        const haystack =
          (article.title + " " + article.description).toLowerCase();
        return haystack.includes(query);
      });

      renderArticles(filtered);
      setCount(filtered.length);
    });

    // ---------- INIT ----------
    createSourceButtons();
  </script>
</body>
</html>
